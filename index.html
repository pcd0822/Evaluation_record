<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>학생 활동 기반 특기사항 생성기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js`;
    </script>
    <script src="https://unpkg.com/docx-preview@0.1.15/dist/docx-preview.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        .header-bg {
            background-color: #E7C6FF;
            position: relative;
        }

        .hidden {
            display: none;
        }

        .spinner {
            border-top-color: #a855f7;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .interactive-section {
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        }

        @keyframes pop-up {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.015);
            }
            100% {
                transform: scale(1);
            }
        }

        .animate-pop {
            animation: pop-up 0.3s ease-out forwards;
        }

        @keyframes gradient-animation {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        #progress-bar {
            background: linear-gradient(-45deg, #f9a8d4, #e9d5ff, #c4b5fd, #a78bfa);
            background-size: 400% 400%;
            animation: gradient-animation 10s ease infinite;
        }
    </style>
</head>

<body class="text-slate-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">

        <header class="text-center mb-12 rounded-2xl overflow-hidden shadow-lg header-bg relative">
            <div class="py-12 px-4">
                <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4 leading-tight">학생 활동 기반 특기사항 생성기</h1>
                <p class="text-lg text-white/90 max-w-2xl mx-auto">AI를 활용하여 학생들의 활동 기록을 의미 있는 특기사항으로 변환하세요.</p>
            </div>
            <p class="absolute bottom-4 right-6 text-sm text-white/50">Designed by 들쌤</p>
        </header>

        <!-- 교육과정-수업 맥락 설정 -->
        <section class="interactive-section mb-8 p-6 bg-white rounded-2xl shadow-lg">
            <div class="flex items-center mb-4">
                <i class="fas fa-sitemap text-indigo-500 text-xl mr-3"></i>
                <h2 class="text-2xl font-bold">교육과정-수업 맥락 설정</h2>
            </div>
            <div class="space-y-4">
                <div>
                    <label for="curriculum-info" class="block text-sm font-medium text-slate-700">관련 교육과정 성취기준 / 단원명 / 학습주제</label>
                    <input type="text" id="curriculum-info" class="mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>
                <div>
                    <label for="class-activity-info" class="block text-sm font-medium text-slate-700">수업(활동) 내용 소개</label>
                    <textarea id="class-activity-info" rows="3" class="mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"></textarea>
                </div>
            </div>
        </section>

        <!-- 특기사항 생성 조건 입력 -->
        <section class="interactive-section mb-8 p-6 bg-white rounded-2xl shadow-lg">
            <div class="flex items-center mb-4">
                <i class="fas fa-cogs text-violet-500 text-xl mr-3"></i>
                <h2 class="text-2xl font-bold">특기사항 생성 조건 입력</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label for="record-type" class="block text-sm font-medium text-slate-700">특기사항 종류</label>
                    <select id="record-type" class="mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent">
                        <option value="교과세특">교과세특</option>
                        <option value="동아리활동">동아리활동</option>
                        <option value="자율활동">자율활동</option>
                        <option value="진로활동">진로활동</option>
                        <option value="행동발달특성">행동발달특성</option>
                    </select>
                </div>
                <div id="subject-wrapper">
                    <label for="subject" class="block text-sm font-medium text-slate-700">과목명</label>
                    <input type="text" id="subject" class="mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent" value="국어">
                </div>
            </div>
            <div class="space-y-4">
                <div>
                    <label for="guidelines" class="block text-sm font-medium text-slate-700">특기사항 입력 시 꼭 반영되어야 할 지침</label>
                    <textarea id="guidelines" rows="3" class="mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent"></textarea>
                </div>
                <div>
                    <label for="start-phrase" class="block text-sm font-medium text-slate-700">특기사항 입력 시 시작 문구</label>
                    <input type="text" id="start-phrase" placeholder="예시: 문학작품 비평하기 활동을 통해~" class="mt-1 block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent">
                </div>
            </div>
        </section>

        <!-- 파일 업로드 -->
        <section class="interactive-section mb-8 p-6 bg-white rounded-2xl shadow-lg">
            <div class="flex items-center mb-4">
                <i class="fas fa-upload text-indigo-500 text-xl mr-3"></i>
                <h2 class="text-2xl font-bold">파일 업로드 및 생성</h2>
            </div>
            <p class="text-slate-600 mb-6">자료 형태에 맞는 업로드 방식을 선택해주세요.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-center">
                <!-- 단일 파일 업로드 버튼 -->
                <button id="single-file-btn" class="p-6 border-2 border-dashed border-slate-300 rounded-lg hover:bg-slate-100 hover:border-indigo-400 transition-colors">
                    <div class="flex justify-center items-center mb-4">
                        <svg class="w-12 h-12 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h3 class="font-semibold text-lg">단일 파일 업로드</h3>
                    <p class="text-sm text-slate-500 mt-1">여러 활동 기록이 단일 파일(엑셀)에 정리된 경우</p>
                </button>

                <!-- 개별 파일 업로드 버튼 -->
                <button id="individual-files-btn" class="p-6 border-2 border-dashed border-slate-300 rounded-lg hover:bg-slate-100 hover:border-violet-400 transition-colors">
                    <div class="flex justify-center items-center mb-4">
                        <svg class="w-12 h-12 text-violet-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <h3 class="font-semibold text-lg">개별 파일 업로드</h3>
                    <p class="text-sm text-slate-500 mt-1">학생 개별 활동 자료를 업로드하는 경우</p>
                </button>
            </div>

            <!-- 단일 파일(엑셀) 업로드 영역 -->
            <div id="single-file-upload-area" class="hidden mt-6 text-center">
                <p class="text-slate-600 mb-4">엑셀 양식을 다운로드하여 내용을 채운 후 업로드해주세요.</p>
                <div class="flex justify-center gap-4">
                    <button id="download-excel-template" class="bg-emerald-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-emerald-600 transition-colors">
                        <i class="fas fa-file-excel mr-2"></i>엑셀 양식 다운로드
                    </button>
                    <button id="upload-excel-btn" class="bg-sky-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-sky-600 transition-colors">
                        <i class="fas fa-file-upload mr-2"></i>엑셀 파일 업로드
                    </button>
                    <input type="file" id="excel-file-input" class="hidden" accept=".xlsx, .xls">
                </div>
            </div>

            <!-- 개별 파일 업로드 영역 -->
            <div id="individual-files-upload-area" class="hidden mt-6">
                <label for="file-input" class="block text-sm font-medium text-slate-700 mb-2">학생 활동 자료 (파일명: 학번 5자리, 예: 20501)</label>
                <input type="file" id="file-input" multiple class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100">
            </div>
        </section>

        <!-- 진행 상황 -->
        <section id="progress-section" class="hidden interactive-section mb-8 p-6 bg-white rounded-2xl shadow-lg">
            <h2 class="text-2xl font-bold mb-4">생성 진행 상황</h2>
            <div class="w-full bg-slate-200 rounded-full h-4 overflow-hidden">
                <div id="progress-bar" class="h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <p id="progress-text" class="text-center mt-2 text-slate-600"></p>
        </section>

        <!-- 생성 결과 -->
        <section id="result-section" class="hidden">
            <div class="p-6 bg-white rounded-2xl shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <i class="fas fa-clipboard-check text-violet-500 text-xl mr-3"></i>
                        <h2 class="text-2xl font-bold">생성 결과</h2>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="reset-data" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-red-600 transition-colors">
                            <i class="fas fa-sync-alt mr-2"></i>자료 초기화
                        </button>
                        <button id="copy-results" class="bg-slate-700 text-white font-semibold py-2 px-4 rounded-md hover:bg-slate-800 transition-colors">
                            <i class="fas fa-copy mr-2"></i>결과 복사하기
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table id="result-table" class="min-w-full divide-y divide-slate-200">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider" style="width: 10%;">학번</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider" style="width: 15%;">평가 수준</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider" style="width: 60%;">특기사항 내용</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider" style="width: 15%;">작업</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-slate-200">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 상세보기 모달 -->
        <div id="details-modal" class="hidden fixed z-50 inset-0 overflow-y-auto">
            <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                    <div class="absolute inset-0 bg-slate-800 opacity-75"></div>
                </div>
                <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
                <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full">
                    <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                        <div class="sm:flex sm:items-start">
                            <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-pink-100 sm:mx-0 sm:h-10 sm:w-10">
                                <i class="fas fa-search-plus text-pink-600"></i>
                            </div>
                            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                                <h3 class="text-lg leading-6 font-medium text-slate-900" id="modal-title">상세 분석 (학번: <span id="modal-student-id"></span>)</h3>
                                <div class="mt-4">
                                    <h4 class="font-semibold">AI 생성 근거</h4>
                                    <p id="modal-ai-reasoning" class="text-sm text-slate-600 mt-1 whitespace-pre-wrap"></p>
                                    <h4 class="font-semibold mt-4">참조한 원본 내용</h4>
                                    <div id="modal-original-content" class="mt-1 p-3 border rounded-md bg-slate-50 h-64 overflow-y-auto text-sm"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-slate-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                        <button type="button" id="close-modal" class="mt-3 w-full inline-flex justify-center rounded-md border border-slate-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-slate-700 hover:bg-slate-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center py-6 text-sm text-slate-500">
        <p>&copy; <span id="copyright-year"></span> Designed by 들쌤. All Rights Reserved.</p>
    </footer>

    <script src="script.js" defer></script>
</body>

</html>
